# Repository Guidelines

## Project Structure & Module Organization
- `index.html` houses the QR scanner UI; keep static assets inline to avoid Netlify build steps.
- `config.js` is generated by `build.ps1` and must only expose `API_URL`; treat edits as derived.
- `mock-server.js` plus `MOCK-SERVER.md` simulate the Apps Script backend for local validation.
- `copy_to_sheets/backend.gs` and `copy_to_sheets/mailer.gs` mirror the production Apps Script; changes must stay in sync with Google Sheets column order (Timestamp -> Mailer Status).
- `build.ps1` reads `.env` (never commit) and emits `mela2025-netlify.zip`; rerun after any frontend or config change.

## Build, Test, and Development Commands
- `npm install` - install Node-only tooling (currently just `nodemon` for hot reload).
- `npm run dev` - run the mock server via nodemon on port 3000 with auto-restart for local UI testing.
- `npm start` or `node mock-server.js [port]` - run the mock API manually; pass ticket IDs such as `MELA25-VALID1` to validate responses.
- `\.\build.ps1` - produce `config.js` from `.env` and bundle `index.html`; required before each Netlify upload.
- `npm test` currently exits with status 1; future automated tests should replace this placeholder before enabling CI.

## Coding Style & Naming Conventions
- JavaScript uses 2-space indentation, trailing semicolons, and `const`/`let` consistently; prefer functional helpers over shared state.
- Apps Script files follow camelCase functions (e.g., `generateQRCodeAndEmail`); keep sheet column names Title Case to match the form headers.
- Ticket codes remain uppercase `MELA25-XXXXX`; derive helper names from the ticket lifecycle (`markTicketUsed`, `lookupTicketByCode`).

## Testing Guidelines
- Exercise new scanner features against the mock server first, then against the live Apps Script endpoint referenced in `.env`.
- Extend `MOCK_TICKETS` inside `mock-server.js` with deterministic fixtures when adding new validation paths, and document them in `MOCK-SERVER.md`.
- When automated tests are introduced, prefer Jest for Node logic and use Apps Script execution logs for backend verification; target at least smoke coverage for ticket validation flows.

## Commit & Pull Request Guidelines
- Follow the existing log style: short, imperative titles (`Add mock server logs`, `Update README for Netlify`) without trailing punctuation.
- Each PR should describe scope, mention related Google Sheet/Form changes, include mock-server ticket examples that can be replayed, and attach UI screenshots for any scanner UI adjustment.

## Security & Configuration Tips
- Keep `.env` local and rotate the Apps Script URL whenever access settings change; regenerate `config.js` instead of editing it by hand.
- Review diffs for accidental inclusion of attendee data or QR codes before pushing; redact sheet IDs from logs and docs.
